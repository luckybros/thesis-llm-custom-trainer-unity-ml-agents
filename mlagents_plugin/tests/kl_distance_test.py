import torch
from mlagents_plugin.utils.llm_utils import LLMUtils

d1 = torch.tensor([[-5.7662e+00, -6.2485e+00, -5.0775e-03],
        [-5.9974e+00, -6.4759e+00, -4.0332e-03],
        [-5.6380e+00, -6.0384e+00, -5.9626e-03],
        [-6.0812e+00, -6.4589e+00, -3.8591e-03]])
d2 = torch.tensor([[-5.7662e+00, -6.2485e+00, -5.0775e-03],
        [-5.9974e+00, -6.4759e+00, -4.0332e-03],
        [-5.6380e+00, -6.0384e+00, -5.9626e-03],
        [-6.0812e+00, -6.4589e+00, -3.8591e-03]])
d3 = torch.tensor([[-5.7662e+00, -6.2485e+00, -5.0775e-03],
        [-5.9974e+00, -6.4759e+00, -4.0332e-03],
        [-5.6380e+00, -6.0384e+00, -5.9626e-03],
        [-6.0812e+00, -6.4589e+00, -3.8591e-03]])
d4 = torch.tensor([[-5.7662e+00, -6.2485e+00, -5.0775e-03],
        [-5.9974e+00, -6.4759e+00, -4.0332e-03],
        [-5.6380e+00, -6.0384e+00, -5.9626e-03],
        [-6.0812e+00, -6.4589e+00, -3.8591e-03]])

D1 = [d1, d2]
D2 = [d3, d4]

D1 = torch.cat(D1, dim=0)
D2 = torch.cat(D2, dim=0)
print(D1)
print(D2)

print(LLMUtils.calculate_kl_distance(D1, D2))

